"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.html=html;exports.default=exports.innerHTML=void 0;function _defineProperty(t,e,r){if(e in t){Object.defineProperty(t,e,{value:r,enumerable:true,configurable:true,writable:true})}else{t[e]=r}return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++){r[e]=t[e]}return r}}function _typeof(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function t(e){return typeof e}}else{_typeof=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(t)}var innerHTML=Symbol("innerHTML");exports.innerHTML=innerHTML;var _engraft="ðŸŽ‹";var Engraft={innerHTML:innerHTML,html:html};var isEmptyObject=function t(e){return Object.entries(e).length===0&&e.constructor===Object};function htmlEscape(t){return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")}function hashCode(t){var e="",r="abcdefghijklmnopqrstuvwxyz".concat(t?"ABCDEFGHIJKLMNOPQRSTUVWXYZ":"","0123456789");for(var n=0;n<15;n++){e+=r.charAt(Math.floor(Math.random()*r.length))}return e}function HTMLtoJSON(t,e){var r;if(typeof t==="string"){var n;if(window.DOMParser){var o=new DOMParser;n=o.parseFromString(t,"text/html")}if(e!=null&&e instanceof HTMLElement){var a=e.tagName,i=e.attributes;var c=null;var l=n.body.children;r={tagName:a,textContent:c,attributes:i,children:l}}}else if(_typeof(t)==="object"){r=t}var u=function t(e){return{tagName:e.tagName,textContent:e.textContent,attributes:Object.fromEntries(Array.from(e.attributes,function(t){var e=t.name,r=t.value;return[e,r]})),children:Array.from(e.children,t)}};return r&&u(r)}function html(t){var v=t.raw;var h="",y=[],m,d=function t(r){if(_typeof(r)==="object"){if(r===null||Object.getOwnPropertyNames(r).length===0)return;else if("_engraft"in r){r.elemEvents.length&&(y=[].concat(_toConsumableArray(y),_toConsumableArray(r.elemEvents)));return r.result}return Object.prototype.toString===r.toString?Object.keys(r).reduce(function(t,e){return t+"".concat(e,": ").concat(r[e],",\n          ")},"[Object toString] "):r}};for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++){r[n-1]=arguments[n]}r.forEach(function(t,e){var r=v[e];var n=_typeof(t);if(t==null||n==="object"&&Object.getOwnPropertyNames(t).length===0){t=""}else{if(Array.isArray(t)){var o="";t.forEach(function(t){return o+=d(t)});t=o||t.join("")}else if(n==="object"){t=r.slice(-8).match(/\s+style=["']/)?Object.entries(t).map(function(t){return t.join(":")}).join(";"):d(t)}else if(n==="function"&&(m=r.slice(-15).match(/\son.*=["']$/))){var a=r.charAt(r.length-1);var i=a.charCodeAt();var c=m[0].slice(3,-2);var l="_engraft-id-"+hashCode();var u=hashCode(true);var f=String(t);if(t.name.startsWith("bound ")&&f.startsWith(n)&&f.includes("native code")){var s=i===34?"'":'"';f="".concat(s).concat(n," ").concat(t.name.substring(5)," ").concat(f.substring(9)).concat(s)}y.push({engraftID:l,engraftIDValue:u,eventHandler:t,eventType:c,handlerBody:f});t="".concat(f).concat(a," ").concat(l,"=").concat(a).concat(u)}}if(r.endsWith("!")){t=htmlEscape(t);r=r.slice(0,-1)}h+=r;h+=t});h+=v[v.length-1];return{result:h,elemEvents:y,_engraft:_engraft}}(function t(){_engraft in window||(window[_engraft]=!function(){var t;Object.defineProperties(HTMLElement.prototype,(t={},_defineProperty(t,innerHTML,{get:function t(){return this.innerHTML},set:function t(e){var f=this;var r=e.result,n=e.elemEvents;console.info("Element is in the DOM?: "+this.isConnected);if(this.isConnected&&!isEmptyObject(this.vdom)){var o=HTMLtoJSON(r,this);var a=this.vdom;var i=function t(e,r){var n=[],o=[],a=[];var i=Object.assign({},r);var c=function r(n,t,e){var o={textContent:"",attributes:{},children:[],index:e};if(t.textContent!=null&&!Object.is(n.textContent,t.textContent)){o.textContent=t.textContent}o.children=t.children.map(function(t,e){return r(n.children[e],t,e)});return o};var l=c(e,r);var u=function r(t,e){var n=t.textContent||"",o=t.children||[];n!=""&&(e.textContent=n);o.forEach(function(t,e){return r(t,f.children[e])})};u(l,f)};var c=function t(){};i(a,o)}else{this.innerHTML=r;this.vdom=HTMLtoJSON(r,this);console.log(this.vdom);var l=true;var u=false;var s=undefined;try{for(var v=n[Symbol.iterator](),h;!(l=(h=v.next()).done);l=true){var y=h.value;var m=y.engraftID,d=y.engraftIDValue,p=y.eventHandler,b=y.eventType,g=y.handlerBody;var _=this.querySelector("[".concat(m,'="').concat(d,'"]'));if(_!=null&&typeof p==="function"){if(!p.name&&g.startsWith("function")){debugger;console.error(g,"function expression must have a name");throw new TypeError("function expression must have a name")}_[b]&&_.addEventListener(b,p);_.removeAttribute(m)}}}catch(t){u=true;s=t}finally{try{if(!l&&v.return!=null){v.return()}}finally{if(u){throw s}}}}},enumerable:true,configurable:true}),_defineProperty(t,"vdom",{value:{},writable:true}),t))}())})();var _default=Engraft;exports.default=_default;