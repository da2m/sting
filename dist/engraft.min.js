"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.html=html;exports.default=exports.innerHTML=void 0;function _defineProperty(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++){r[t]=e[t]}return r}}function _typeof(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function e(t){return typeof t}}else{_typeof=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return _typeof(e)}var innerHTML=Symbol("innerHTML");exports.innerHTML=innerHTML;var _engraft="ðŸŽ‹";var Engraft={innerHTML:innerHTML,html:html};var isEmptyObject=function e(t){return Object.entries(t).length===0&&t.constructor===Object};function htmlEscape(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")}function hashCode(e){var t="",r="abcdefghijklmnopqrstuvwxyz".concat(e?"ABCDEFGHIJKLMNOPQRSTUVWXYZ":"","0123456789");for(var n=0;n<15;n++){t+=r.charAt(Math.floor(Math.random()*r.length))}return t}function HTMLtoJSON(e,t){var r;if(typeof e==="string"){var n;if(window.DOMParser){var o=new DOMParser;n=o.parseFromString(e,"text/html")}if(t!=null&&t instanceof HTMLElement){var a=t.tagName,i=t.attributes;var c=null;var l=n.body.children;r={tagName:a,textContent:c,attributes:i,children:l}}}else if(_typeof(e)==="object"){r=e}var u=function e(t){return{tagName:t.tagName,textContent:t.textContent,attributes:Object.fromEntries(Array.from(t.attributes,function(e){var t=e.name,r=e.value;return[t,r]})),children:Array.from(t.children,e)}};return r&&u(r)}function html(e){var v=e.raw;var h="",d=[],y,m=function e(r){if(_typeof(r)==="object"){if(r===null||Object.getOwnPropertyNames(r).length===0)return;else if("_engraft"in r){r.elemEvents.length&&(d=[].concat(_toConsumableArray(d),_toConsumableArray(r.elemEvents)));return r.result}return Object.prototype.toString===r.toString?Object.keys(r).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t],",\n          ")},"[Object toString] "):r}};for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++){r[n-1]=arguments[n]}r.forEach(function(e,t){var r=v[t];var n=_typeof(e);if(e==null||n==="object"&&Object.getOwnPropertyNames(e).length===0){e=""}else{if(Array.isArray(e)){var o="";e.forEach(function(e){return o+=m(e)});e=o||e.join("")}else if(n==="object"){e=r.slice(-8).match(/\s+style=["']/)?Object.entries(e).map(function(e){return e.join(":")}).join(";"):m(e)}else if(n==="function"&&(y=r.slice(-15).match(/\son.*=["']$/))){var a=r.charAt(r.length-1);var i=a.charCodeAt();var c=y[0].slice(3,-2);var l="_engraft-id-"+hashCode();var u=hashCode(true);var f=String(e);if(e.name.startsWith("bound ")&&f.startsWith(n)&&f.includes("native code")){var s=i===34?"'":'"';f="".concat(s).concat(n," ").concat(e.name.substring(5)," ").concat(f.substring(9)).concat(s)}d.push({engraftID:l,engraftIDValue:u,eventHandler:e,eventType:c,handlerBody:f});e="".concat(f).concat(a," ").concat(l,"=").concat(a).concat(u)}}if(r.endsWith("!")){e=htmlEscape(e);r=r.slice(0,-1)}h+=r;h+=e});h+=v[v.length-1];return{result:h,elemEvents:d,_engraft:_engraft}}(function e(){_engraft in window||(window[_engraft]=!function(){var e;Object.defineProperties(HTMLElement.prototype,(e={},_defineProperty(e,innerHTML,{get:function e(){return this.innerHTML},set:function e(t){var f=this;var r=t.result,n=t.elemEvents;console.info("Element is in the DOM?: "+this.isConnected);if(this.isConnected&&!isEmptyObject(this.vdom)&&!document.contains(this)){var o=HTMLtoJSON(r,this);var a=this.vdom;var i=function e(t,r){var n=[],o=[],a=[];var i=Object.assign({},r);var c=function r(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{textContent:"",children:[]};var e=arguments.length>1?arguments[1]:undefined;var t=arguments.length>2?arguments[2]:undefined;var o={textContent:"",attributes:{},children:[],index:t};var a=n.textContent;var i=e.textContent;if(i!=null&&!Object.is(a,i)){o.textContent=i}o.children=e.children.map(function(e,t){return r(n.children[t],e,t)});return o};var l=c(t,r);var u=function r(e,t){var n=e.textContent||"",o=e.children||[];n!=""&&(t.textContent=n);o.forEach(function(e,t){return r(e,f.children[t])})};u(l,f)};var c=function e(){};i(a,o)}else{this.innerHTML=r;this.vdom=HTMLtoJSON(r,this);console.log(this.vdom);var l=true;var u=false;var s=undefined;try{for(var v=n[Symbol.iterator](),h;!(l=(h=v.next()).done);l=true){var d=h.value;var y=d.engraftID,m=d.engraftIDValue,p=d.eventHandler,b=d.eventType,g=d.handlerBody;var _=this.querySelector("[".concat(y,'="').concat(m,'"]'));if(_!=null&&typeof p==="function"){if(!p.name&&g.startsWith("function")){debugger;console.error(g,"function expression must have a name");throw new TypeError("function expression must have a name")}_[b]&&_.addEventListener(b,p);_.removeAttribute(y)}}}catch(e){u=true;s=e}finally{try{if(!l&&v.return!=null){v.return()}}finally{if(u){throw s}}}}},enumerable:true,configurable:true}),_defineProperty(e,"vdom",{value:{},writable:true}),e))}())})();var _default=Engraft;exports.default=_default;