"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.html=html;exports.default=exports.innerHTML=void 0;function _defineProperty(t,e,r){if(e in t){Object.defineProperty(t,e,{value:r,enumerable:true,configurable:true,writable:true})}else{t[e]=r}return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++){r[e]=t[e]}return r}}function _typeof(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function t(e){return typeof e}}else{_typeof=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(t)}var innerHTML=Symbol("innerHTML");exports.innerHTML=innerHTML;var _engraft="ðŸŽ‹";var Engraft={innerHTML:innerHTML,html:html};var isEmptyObject=function t(e){return Object.entries(e).length===0&&e.constructor===Object};function htmlEscape(t){return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")}function hashCode(t){var e="",r="abcdefghijklmnopqrstuvwxyz".concat(t?"ABCDEFGHIJKLMNOPQRSTUVWXYZ":"","0123456789");for(var n=0;n<15;n++){e+=r.charAt(Math.floor(Math.random()*r.length))}return e}function HTMLtoJSON(t,e){var r;if(typeof t==="string"){var n;if(window.DOMParser){var a=new DOMParser;n=a.parseFromString(t,"text/html")}if(e!=null&&e instanceof HTMLElement){var o=e.tagName,i=e.attributes;var c=n.body.textContent;var u=n.body.children;r={tagName:o,textContent:c,attributes:i,children:u}}}else if(_typeof(t)==="object"){r=t}var l=function t(e){return{tagName:e.tagName,textContent:e.textContent,attributes:Object.fromEntries(Array.from(e.attributes,function(t){var e=t.name,r=t.value;return[e,r]})),children:Array.from(e.children,t)}};return r&&l(r)}function html(t){var v=t.raw;var y="",b=[],h,m=function t(r){if(_typeof(r)==="object"){if(r===null||Object.getOwnPropertyNames(r).length===0)return;else if("_engraft"in r){r.elemEvents.length&&(b=[].concat(_toConsumableArray(b),_toConsumableArray(r.elemEvents)));return r.result}return Object.prototype.toString===r.toString?Object.keys(r).reduce(function(t,e){return t+"".concat(e,": ").concat(r[e],",\n          ")},"[Object toString] "):r}};for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++){r[n-1]=arguments[n]}r.forEach(function(t,e){var r=v[e];var n=_typeof(t);if(t==null||n==="object"&&Object.getOwnPropertyNames(t).length===0){t=""}else{if(Array.isArray(t)){var a="";t.forEach(function(t){return a+=m(t)});t=a||t.join("")}else if(n==="object"){t=r.slice(-8).match(/\s+style=["']/)?Object.entries(t).map(function(t){return t.join(":")}).join(";"):m(t)}else if(n==="function"&&(h=r.slice(-15).match(/\son.*=["']$/))){var o=r.charAt(r.length-1);var i=o.charCodeAt();var c=h[0].slice(3,-2);var u="_engraft-id-"+hashCode();var l=hashCode(true);var s=String(t);if(t.name.startsWith("bound ")&&s.startsWith(n)&&s.includes("native code")){var f=i===34?"'":'"';s="".concat(f).concat(n," ").concat(t.name.substring(5)," ").concat(s.substring(9)).concat(f)}b.push({engraftID:u,engraftIDValue:l,eventHandler:t,eventType:c,handlerBody:s});t="".concat(s).concat(o," ").concat(u,"=").concat(o).concat(l)}}if(r.endsWith("!")){t=htmlEscape(t);r=r.slice(0,-1)}y+=r;y+=t});y+=v[v.length-1];return{result:y,elemEvents:b,_engraft:_engraft}}(function t(){_engraft in window||(window[_engraft]=!function(){var t;Object.defineProperties(HTMLElement.prototype,(t={},_defineProperty(t,innerHTML,{get:function t(){return this.innerHTML},set:function t(e){var r=e.result,n=e.elemEvents;console.info("Element is in the DOM?: "+this.isConnected);if(this.isConnected&&!isEmptyObject(this.vdom)){console.log("here we go");var a=HTMLtoJSON(r,this);var o=this.vdom;var i=function t(e,r){var n=[],a=[],o=[],i=[];var c=Object.assign({},r);var u=function t(e,r){var n={textContent:"",attributes:{},children:[]};Object.is(e.textContent,r.textContent)||(n.textContent=r.textContent);var a=Object.keys(e.attributes);var o=Object.keys(r.attributes);var i=new Set([].concat(_toConsumableArray(a),_toConsumableArray(o)));var c=true;var u=false;var l=undefined;try{for(var s=i[Symbol.iterator](),f;!(c=(f=s.next()).done);c=true){var v=f.value;if(a.includes(v)){Object.is(e.attributes[v],r.attributes[v])||(n.attributes[v]=r.attributes[v])}else{n.attributes[v]=r.attributes[v]}}}catch(t){u=true;l=t}finally{try{if(!c&&s.return!=null){s.return()}}finally{if(u){throw l}}}return n};console.log("result diff: ",u(e,r))};var c=function t(){};i(o,a)}else{this.innerHTML=r;this.vdom=HTMLtoJSON(r,this);console.log(this.vdom);var u=true;var l=false;var s=undefined;try{for(var f=n[Symbol.iterator](),v;!(u=(v=f.next()).done);u=true){var y=v.value;var b=y.engraftID,h=y.engraftIDValue,m=y.eventHandler,d=y.eventType,p=y.handlerBody;var g=this.querySelector("[".concat(b,'="').concat(h,'"]'));if(g!=null&&typeof m==="function"){if(!m.name&&p.startsWith("function")){debugger;console.error(p,"function expression must have a name");throw new TypeError("function expression must have a name")}g[d]&&g.addEventListener(d,m);g.removeAttribute(b)}}}catch(t){l=true;s=t}finally{try{if(!u&&f.return!=null){f.return()}}finally{if(l){throw s}}}}},enumerable:true,configurable:true}),_defineProperty(t,"vdom",{value:{},writable:true}),t))}())})();var _default=Engraft;exports.default=_default;